\begin{quote}
	\textit{``The sinister thing about a simstim construct, really, was that it carried the suggestion that any environment might be unreal, that the windows of the shopfronts she passed now with Andrea might be figments.''}
\end{quote}
\hfill \textit{Count Zero, William Gibson}
\\
\\
\\

%=========================================================================================================
%=========================================================================================================

This chapter presents the development of a preliminary PR system that combined a tablet computer, GPS, accelerometer \& magnetometer, with an OpenSim based virtual environment to allow exploration of the real world ruins of a 14th century cathedral with a complete, atmospheric virtual reconstruction of it as it stood in its prime. Cultural heritage is introduced as an ideal area for which PR systems can be applied to beneficial effect, while the accuracy of GPS tracking emerged as a constraint on this style of interaction.

%=========================================================================================================

\section{Virtual Heritage}

Alternate reality technologies have a long \& fruitful history of applications to aid in the investigation, understanding \& dissemination of information pertaining to our past.

%http://en.wikipedia.org/wiki/Virtual_heritage

Virtual heritage and cultural heritage have independent meanings: cultural heritage refers to sites, monuments, buildings and objects "with historical, aesthetic, archaeological, scientific, ethnological or anthropological value",[2] whereas virtual heritage refers to instances of these within a technological domain, usually involving computer visualization of artefacts or Virtual Reality environments.

\textbf{Citation for the terms `digital heritage' \& 'virtual heritage'.}

\textbf{Put some pictures in here, maybe one of VR applied to heritage \& one of AR applied to heritage.}

\clearpage

%=========================================================================================================
% AR citations
%=========================================================================================================

The application of alternate reality techniques to cultural heritage promises particular benefits to young people as cultural heritage sites often arouse little involvement in them, especially when the site's present day appearance bears few traces of its original stature~\cite{ardito:combining}.

%=======

Visual knowledge of a target scene has been employed to allow rendering of 3D virtual characters atop real views of Sajeongjeon and Gangnyeongjeon of Gyeongbokgung, representative of cultural heritage sites in Korea, without the need for additional sensors, by visually tracking a rectangular structure within the environment whose corners represented robust features for visual tracking~\cite{Kim2009,}. This approach addressed the inherent issues associated with tracking for augmented reality tours in cultural heritage sites due to the variation of tracking targets \& environments at such sites, by developing a visual tracking approach that can be applied to a wider range of sites~\cite{Seo2010}.

%=======

The combination of different categories of alternate reality \& multimedia techniques into a contiguous platform for building \& managing exhibitions of 3D models of artefacts accessed in museums, galleries \& via the Web has been investigated~\cite{Wojciechowski2004}. This project, which involved the use of Web3D technologies, focussed not only on the digitization \& subsequent interaction with such content to aid its preservation \& protection, but also with making these resources as widely available as possible to any interested parties (scientists, archaeologists, curators, historians \& casual citizens)~\cite{walczak:applications}.

%=======

\textbf{***What was the medium for the display here? HMD? CAVE? Screen? Talks about omnidirectional cameras for recording.}

The concepts of augmented reality \& telepresence have been combined, creating `augmented telepresence', to allow participants to experience a `fly-through' of the ancient Nara Heijo-kyo capital of Japan, by combining aerially captured omnidirectional video augmented with related information using AR techniques~\cite{Okura2006,Okura2011}.

%=======

\textbf{***Video see through \& enhanced mobility by using a UMPC, this deserves better talking about in relation to Mirrorshades.}

See-through video glasses, \textbf{***definition here, will be important later because MShades is see-through}, combined with an ultra mobile PC, have been used to render virtual humans as interfaces to virtual cultural heritage content including other real-time augmentations of 3D superimpositions of virtual content atop the view of the real, whilst allowing enhanced mobility compared to traditional approaches~\cite{Magnenat-Thalmann2008a}.

%=======

\textbf{***This needs talking about in relation to VTW, as it used different physical platforms each(?) with GPS \& compass readings.}

\textbf{***Is there any more later work about ARCHEOGUIDE? Seems like it would have spawned more work/publications.}

The ARCHEOGUIDE project (Augmented Reality-based Cultural Heritage On-site GUIDE) aimed to provide a `personalized electronic guide \& tour assistant' to cultural heritage site visitors. On-site help \& augmented reality reconstructions of on-site ruins were presented via a laptop, a tablet computer \& a PDA, using GPS for location tracking \& magnetometer to ascertain direction such that augmentations could be placed accordingly. The applications claimed to be supported by the platform range from archaeological research to education, multimedia publishing \& cultural tourism. The platform was prototyped at the archaeological site of Olympia, Greece~\cite{vlahakis:archeoguide}.

%=======

multi modal

The collaborative benefits of alternate reality technologies for archaeological excavations has been explored by VITA (Visual Interaction Tool for Archaeology), which allowed off-site visualisation of an archaeological dig site such that multiple users could collaborate whilst visualising the dig environment via a range of visual displays; a video see-through, head-tracked head mounted display, a projected table surface, a large screen display \& tracked hand-held displays. This provided new ways to organise, visualise \& combine the traditional 2D information associated with archaeological digs with 3D models of artefacts \& the site itself~\cite{benko:collaborative}.

%=======

2008

Real time animation \& illumination was used in a virtual reality restitution of the Roman theatre of Aspendos in Turkey, visualised as it was in the 3rd century, \& an on-site augmented reality simulation of a Thermopolium situated within Pompeii in Italy. Both included real time animated virtual humans, programmed to re-enact situations \& activities typical of their sites \& both actors \& the scenes themsevles were rendered using real time illumination strategies~\cite{Magnenat-Thalmann7}.

%=======

\textbf{*** On-site VR is not well represented, especially *mobile* on-site VR, the combination of mobility \& on-site is exclusively(?) employed by AR rather than VR}

%=======

\textbf{***See which came first, this or Magnenat-Thalmann7}

\textbf{2005 onwards}

The concept of real-time humans in AR sites was further investigated in the LIFEPLUS EU IST project, which aimed to produce ``an innovative 3D reconstruction of ancient frescos-paintings through the real-time revival of their fauna and flora, featuring groups of virtual animated characters with artificial life dramaturgical behaviors, in an immersive AR environment''. This project pushed established augmented reality applications to the field by exploring narrative design in fictional spaces, with the aim of increasing immersion via realistic interaction, making use of captured/real-time video of a real scene~\cite{Papagiannakis2004}, presenting the visitor with ``an immersive and innovative multi-sensory interactive trip to the past''~\cite{Papagiannakis2005}.

These realistic simulations of animated virtual human actors were employed in a mobile \& wearable setup, in abandonment of traditional concepts of static cultural artefacts or rigid augmentations of real world features, making use of a markerless camera tracker \& a PRT\textbf{(???)} mixed reality illumination model for more consistent real-virtual \& virtual-real rendering. This platform was demonstrated in a case study on the real site of ancient Pompeii. Whilst initially targetted at the cultural heritage sector, the author(s) clarifies that as a platform it in no way limited to use with such subjects~\cite{Papagiannakis2007}. The concept of extended rigid \& static AR with character-based event representations was pushed further by the author(s), with hopes of rereating not just discrete artefacts but the entirety of `daily life' in Pompeii~\cite{Papagiannakis2009}.

%=======

The use of omnidirectional range sensing for registration of real \& virtual content at cultural heritage sites has been explored, combining these close local shapes aquired from rangefinding with a landmark database of the large scale environment to achieve accurate registration for AR sightnseeing in historic sites~\cite{Taketomi2011}.

\clearpage

%=========================================================================================================
% VR citations
%=========================================================================================================

\textbf{***It seems that I don't really have many citations (in here at least, check Mendeley/folders) for *VR* being used in cultural heritage, but I have plenty for AR. Surely there must be lots more showing VR being used in CAVEs \& HMD (I'm thinking of one paper in particular that I don't think is cited here, has nice photos in)? I want to show that both AR \& VR have been applied to cultural heritage, but whereas AR maintains user mobility \& VR provides more atmospheric immersion, there haven't really been any attempts to combine the two \& allow users to be mobile in an atmospheric immersive VR counterpart to a real location.}

In particular, virtual reality has been used to allow people to immerse themselves in reconstructions of places that no longer exist \& augmented reality has been used to introduce pieces of the past atop a view of what remains in the real world today.

%=======

\textbf{***Does this actually mention any alternate reality stuff, or should I just use it as a citation for the importance of atmospheric immersion to experience virtual content in cultural heritage?}

\textbf{*** Major good quote for VR (\& thus PR) vs AR!!!}

deamicis:gamebased

Game based technology to enhance the learning of history and cultural heritage

Abstract only that talks about the use of game technologies to support learning of users
within cultural heritage sites. Says that the level of realism is ideal to visualise cultural
heritage if a string focus on the environment's atmosphere \& immersion is required, "emphasising
environmental effects such as fog, sky, water, particles", all of which self-proclaimed virtual
worlds aren't as good at.
        
Uses Unity3D! Mentions that it can produce web browser based applications as well as standalone
ones, has a simple authoring interface \& "exploits the latest graphical hardware by making extensive
use of shaders to deliver high quality graphics".

%=======

\textbf{***A lot of this is about virtual heritage in general \& would be good to open the section with, rather than trying to use it as a specifically VR citation.}

roussou:photorealism

Photorealism and Non-Photorealism
in Virtual Heritage Representation

The area of virtual heritage has long been concentrated on generating digital reconstructions of historical or
archaeological artefacts and sites with enough fidelity to be truly accurate representations of their real-world
counterparts. In some cases, the advancement of tools and techniques for achieving greater visual realism has
distracted from the development of other directions that enhance a virtual experience, such as interactivity, sound
or touch. Recent trends in the area of non-photorealistic rendering shift focus to the development of more “believable”
environments, while maintaining the accuracy and validity of the visualised data, which is significant for
archaeological research. In this paper we argue that it is important to enhance the perception of realism, achieved
both through photorealistic and non-photorealistic visualisation approaches, with interactivity. This is illustrated
by two example projects which develop prototype virtual environments created for specialists as well as novice
users.

\textbf{***Definition of virtual heritage} - "Virtual heritage, broadly defined, involves the synthesis, conservation,
reproduction, representation, digital reprocessing, and display of cultural evidence with the use of
advanced imaging technology."
        
"...virtual heritage has long been concentrated on generating digital reconstructions of historical or
archaeological artefacts and sites with enough fidelity to be truly accurate representations of their real
world counterparts."
        
Contrasts between photorealistic \& non-photorealistic computer graphics and that for some users the realism
isn't the most important factor, but rather how believeable \& convincing it is, regardless if the imagery
emulates the physical properties of the real world or not. More 'artistic' means of expression can that do
not necessarily hold true to a photographic view of a site can nonetheless be important to a user's understanding.
        
"In virtual heritage representation, architectural walkthroughs and picture-perfect simulations of objects
have defined a practice where photorealism is considered as perhaps the most important measure of a
successful representation."
        
But...
        
"...the emphasis on achieving a high degree of realism runs the risk of limiting VR reconstruction to the
creation of historically accurate yet static worlds that leave little flexibility for interpretive and/or
educational use."
        
So advanced realistic modelling techniques are good for accuracy \& authenticity, but non-photorealistic methods
can provide appropriate tools for more flexible uses in virtual heritage applications. This paper tries to
combine both photorealism \& interactivity into the same virtual reality framework under the CREATE project.
        
"...heritage is 'as much about the living and evolving place, people, and environment as it is about any
single static monument'"
        
"In the case of an archaeology scholar who intends to restore the ancient monument, the goal is to offer
the possibility to try varied reconstruction hypotheses and choose the most plausible."

===AND=== (same people)

Roussou2002

Virtual Heritage : From the Research Lab to the Broad Public

The use of immersive Virtual Reality (
VR
) technology accounts almost a decade of research performed exclusively by the academic,military,and industrial research and development communities. However,as
VR
technologies mature,research is expanding from themilitary and scientific visualisation realm into more multidisciplinary areas,such as education,archeology,art,culture,and thehumanities. As representative institutions involved in the research and presentation of these fields,museums and cultural heritage centresmay be in a better position to make use of advanced virtual reality technologies and contribute to a broad-based public acceptance of technology as a tool for the study and presentation of the past. Nevertheless,the prohibitive costs and inaccessibility of immersive
VR
technologies,coupled with theoretical issues and issues of usability,user training,operation,and maintenance,continue to present  practical drawbacks,especially for the cultural and educational use of 
VR
. This paper explores some of these issues through examples of immersive virtual heritage applications for the broad public.


\textbf{***Very good introduction to the use of virtual reality in the realm of heritage, lots of useful definitions.}
        
"The use of immersive VR technology accounts almost a decade of research" (as of publication in 2000)
        
"a tool for the study and presentation of the past"
        
"the visualization of abstract concepts and ideas, spaces that are unreachable or no longer exist, or objects
that must be examined from diverse and unique points of view"
        
"heritage refers to the study of human activity not only through the recovery of remains, as is the case
with archaeology, but also through tradition, art \& cultural evidences, narratives, etc."
        
"To virtualize heritage means to actualize it digitally, to simulate it using computer graphics technology..."
        
Lots more, etc.

%=======

cabral:x3dexperience

An experience using X3D for virtual cultural heritage

CAVE

In this paper we present our experience in using Virtual Reality
Technologies to accurately reconstruct and further explore ancient
and historic city buildings. Virtual reality techniques provide a
powerful set of tools to explore and access the history of a city.
In order to explore, visualize and hear such history, we divided the
process in three phases: historical data gathering and analysis; 3D
reconstruction and modeling; interactive immersive visualization,
auralization and display. The set of guidelines devised helped to
put into practice the extensible tools available in VR but not al-
ways easy to put together by inexperienced users. These guidelines
also helped the smoothness of our work and helped avoiding prob-
lems in the subsequent phases. Most importantly, the X3D standard
provided an environment capable of helping the design and vali-
dation process as well as the visualization phase. To finalize, we
present the results achieved and further analyze the extensibility of
the framework. Although VR tools and techniques are widely avail-
able at present, there is still a gap between using the tools and re-
ally taking advantage of VR in historic architectural reconstruction
so that users might immerse themselves into this world and thus be
able to consider various scenarios and possibilities that might lead
to new insightful inspiration. This is an ongoing process that we
think will increase and help current architectural development.

%=======

Leveraging a model of an ancient Greek templed in Messene created as part of the CREATE project, a system made use of a CAVE-like theatre, consisting of head-tracked user localization, a 2-armed haptic interface with realistic physics engine \& 3D sound, to host large scale visualizations of cultural heritage sites. Initial user studies into the usability \& performance of the system employed a simple task to ascertain the benefit (if any) of the haptic interface, while an additional qualitative study of the final system took place while it was installed in a museum~\cite{Christou2006}.

\textbf{***Useful quote for the shortcomings of self-proclaimed virtual worlds - "Such environments suffer
either from a lack of realism or a low degree of interactivity, due to technological and
methodological constraints.".}

%=======

\textbf{***Use as reference for performance of Mirrorshades/Unity vs VTW/OpenSim - talks about a lot of fundamental graphics optimization things but in a heritage setting}

willmott:largecomplex

Rendering of large and complex urban environments for real time heritage reconstructions

In this paper we describe a rendering package, which brings
together a number of rendering techniques and optimisations to
render large and complex urban environments at interactive frame
rates. The package has been built on top of a proprietary Scene
Graph structure developed for the CHARISMATIC project. The
paper presents an integrated approach combining Real-time
Optionally Adapting Meshes, View Frustum Culling, Occluder
Shadows, Level of Detail for Houses and Motion Captured
Avatars in a single application.

We discuss the performance issues associated with our
approaches and give comprehensive implementation details. We
also consider implications of the trends in high performance
graphics sub-systems for PCs in the context of data types and
animations required for populated interactive virtual heritage
experiences. Finally we present empirical results to demonstrate
the importance of employing such techniques and the implications
for practical virtual heritage applications.


Presents a rendering package with heavy focus on optimizations such as not rendering buildings
that are obscured by buildings in front of them, rendering buildings features like windows into
the wall textures so from a distance it looks as though the windows are there so they only need to
actually be rendered at closer range \& the difference is less noticeable.

%=======

\textbf{***This is actually from Virtual Space (Qvortrup)}

Tzortzaki2002

Virtual Reality as Simulation: The CAVE as "Space of Illusion" in Museum Displays

But this chapter is not about virtual museums and cyberspace. It is rather concerned with the use of virtual reality (VR) within the very physical space of museums.

That form of interplay between physicality and digitality in museum displays, in order for something which is not physically present to be re-presented, creates a particular ``space of illusion'', which I will explore in the following pages.

%=========================================================================================================

AR has been used to add artefacts, actors \& reconstructed architecture to views of present day sites that bear traces of their original status, whilst VR has been used to host more complete reconstructions of entire buildings \& settlements for interaction via screen, HMD \& CAVE, including where the present day site bears no evidence of the past status or is inaccessible for some reason (due to latter development, change in landscape, etc.).

In situations where VR content exists in cultural heritage contexts, it is experienced from a static position that causes both spatial \& temporal separation from the RW location that it relates to; in order to perform comparisons between RW \& VR content, users must interact with one \& \textit{subsequently} the other. A mobile XR platform will allow VR content in cultural heritage contexts to be experienced in tandem with the real site (where accessible), combining the immediate juxtaposition of real \& virtual content of AR with the immersive \& atmospheric qualities of HMD based VR, all without requiring alterations to the VR content (for example to make it compatible with an AR framework).

%fixed/anchored AR interface~\cite{Weng2012}

%=========================================================================================================

\subsection{Digital Heritage at the University of St Andrews}

Motivation for this platform stemmed from a desire to leverage an existing virtual model of a 14th century cathedral in parallel with the present day ruins of the cathedral in the real world.

To build upon existing work within the Open Virtual Worlds research group, to allow our existing content to be accessed in a new \& exciting manner that also adds to its experience \& understanding.



The capacity of 3D environments to provide extensible collaborative platforms for the reconstruction of cultural heritage sites and the potential of such reconstructions to promote understanding of and engagement with cultural heritage content both in public and classroom settings has been demonstrated~\cite{Allison2012,Kennedy2012}. This research tested various deployment scenarios, leveraging different control methodologies (traditional keyboard and mouse, Xbox controllers and gesture recognition via Kinect) and display options (regular 24'' desktop monitors, larger 40'' televisions and still larger 150'' projection) along with voice interaction with actors playing the parts of historical figures. These scenarios support three deployment modes; a network of reconstructions accessible via the Internet as part of the OpenSim hypergrid; portable LAN exhibitions where multiple computers are connected to a server via local network suitable for classroom use; and immersive installations combining projection and Kinect for use in museums and cultural heritage centers. In all these scenarios a recurrent theme has been the relationship between the virtual reconstruction and the physicality of the corresponding physical site. Frequently projects have involved interactions with the reconstruction and subsequent visits and tours of the physical site; however the temporal separation between these activities makes it harder to appreciate the sometimes complex relationships between the two. To overcome this temporal separation of experiencing the virtual and the real it is necessary for the virtual representation to be accessible in tandem at the physical site by overcoming the vacancy problem.

The same pioneering collaborations between computer scientists, educationalists and historians that led to the creation of the St Andrews cathedral reconstruction have also led to the creation of reconstructions of; a 6th Century Spartan Basilica, Virtual Harlem (1921), Linlithgow Palace (1561), Brora Salt Pans (1599), Featherstone Fishing Station (19th century), Eyemouth Fort (1610), an Iron Age Wheel House and Caen Township (1815). These reconstructions provide a platform for interactive historical narratives, a stage for visitors to play upon and engage in both serious (and not so serious) games both alone and with other users, and serve as a focal point for educational investigations into local history and culture [9, 18]. The reconstructions have been widely used in a range of real world educational contexts. In the formal sector they have been a vehicle for investigative research, part of degree accredited university modules and used in both primary and secondary education. They have also been used as the content for interactive museum installations, art installations and community groups. This has involved further collaborations with Education Scotland, Historic Scotland, SCAPE Trust, Timespan cultural center, the Museum of the University of St Andrews (MUSA), Madras College, Linlithgow Palace and Strathkiness Primary School.


%=========================================================================================================

\section{Designing a Virtual Time Window}

pervasive provision of these devices 

Widespread adoption of smartphones \& tablets in recent years has enabled people to multiplex their physical reality, where they engage in face-to-face social interaction, with Web-based social networks and apps\cite{Accenture2012}. Whilst such PolySocial situations are now commonplace with such 2D apps \& Web content, using smartphones \& tablets to multiplex real \& virtual environments in a parallel reality setting has not yet been attempted.

The suitability of smartphones \& tablets for location aware browsing of virtual content has been leveraged by AR apps, however their suitability for browsing a complete virtual environment parallel to the user's real location has not been thoroughly explored.

\subsection{Second Life/OpenSim}

Talk about history of Second Life/OpenSim in academia/research, including original cross reality research.

\subsection{VTW within PR}

How with VTW we have a small `window' into the virtual, which is then surrounded by the real. So unlike Mirrorshades which is about distributing attention by time (one environment, then the other), VTW is about distributing attention by gaze/place (different parts of a single view/combined environment).

%=========================================================================================================

\section{Building a Virtual Time Window}

\begin{itemize}
	\item Arduino + `accelerometer' as joystick for Second Life
	\item OpenSim RegionModules \& GPS (server side positional tracking/control)
	\item Arduino + HMC6343 + u-blox MAX-6
	\item Control Second Life with GPS, accelerometer \& magnetometer - in particular cover the structure of the Second Life client \& where/how the modifications were effected \& how the menu items are inserted (separate blog post) (even mention silly glh-linear fixes?) And Arduino code/structure/HEX/etc. I did lots of stuff here!
\end{itemize}

%=========================================================================================================

\section{Using the Virtual Time Window}


%=========================================================================================================
%=========================================================================================================











The project described in this paper addressed these omissions with the Pangolin virtual world viewer~\cite{Daviesa} that uses a tablet computer with location and orientation sensors to provide users with a mobile cross reality interface allowing them to interact with 3D reconstructions of cultural heritage sites whilst simultaneously exploring the corresponding physical site, providing a sense of presence at both the physical site and in the reconstruction.


Tracking user position, instead of requiring them to manually control/update their position. substantially lightens the cognitive load of maintaining a presence in a virtual environment, which is one of the main contributors to the vacancy problem.

This paper presents a cross reality project in which there is a high degree of spatial equivalence between the real and virtual environments, as it deals with bringing together virtual reconstructions of cultural heritage sites with their corresponding real locations. The backdrop for many of the experiments is the impressive ruins of the St Andrews cathedral, while the virtual environment is a `distorted'~\cite{lifton:merging} OpenSim simulation of the same location that presents a historically accurate reconstruction of the cathedral as it would have stood at the peak of its former glory~\cite{Kennedy2012, OpenVirtualWorldsgroupSchoolofComputerScience} (see figure \ref{cathedral_picture}).

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_1}
%\caption{OpenSim reconstruction of the St Andrews cathedral.}
%\label{cathedral_picture}
%\end{figure}



The project described in this paper furthers this previous work by developing a mobile interface to allow students to explore both a physical site and its virtual reconstruction in tandem, rather than having to explore the reconstruction from a computer in the classroom and trying to relate what they had seen to a visit to the physical site at a later date. Figure \ref{separation_map} shows how small the spatial separation between the classroom and the physical site was during a session with students at St Andrews' Madras College. This project, introduced in~\cite{Davies2012}, developed a modified version of the Second Life viewer called Pangolin, which through use of sensors allows movement of the avatar and camera to be implicitly controlled by sensing the physical position and orientation of the tablet computer which the user carries and upon which the viewer executes. Figure \ref{pangolin_in_action} depicts the system in use at the St Andrews cathedral.

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/separation_map}
%\caption{Aerial photograph of St Andrews demonstrating the distance between Madras College (left ring) and the cathedral itself (right ring). The distance between the two sites is roughly 650m, with the photograph being approximately 1km across.}
%\label{separation_map}
%\end{figure}

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_3}
%\caption{The Pangolin viewer running on a tablet computer at the St Andrews cathedral, with the camera orientation of the viewer synchronised to the physical orientation of the tablet, the view of the virtual reconstruction corresponding to that of the physical ruins.}
%\label{pangolin_in_action}
%\end{figure}

This system promises to augment exploration of cultural heritage sites by allowing convenient navigation of the 3D reconstruction and stimulating reflection through the close juxtaposition of the remains and an accessible interpretation. The use of a complete virtual environment also allows for the possibility of interaction between individuals and groups at the site with remote participants, including domain experts, who are connected to the reconstruction from a distant physical location.

\section{Methods}
\subsection{Virtual Environment}
The 3D virtual environment component of the Pangolin system was implemented using the Second Life/OpenSimulator (SL/OpenSim) platform, which provides a 3D social-oriented multi-user non-competitive virtual environment which focuses on the community, creation and commerce~\cite{Sevan2008} aspects of many users interacting within a shared space through the abstraction of avatars, rather than the competitive natures of games and the solitary environments commonly afforded by simulation and visualization platforms. The distributed client/server model of SL/OpenSim, wherein 3D content is stored on a grid of servers operated by a multitude of organizations and distributed to and navigated between by dispersed clients on demand when they enter a particular region rather than being pre-distributed as is the norm for games, simulations and visualizations, is analogous to the manner in which 2D social Web content is served from Web servers to client browsers and apps. This style of content delivery is necessary when considering the dynamic and ephemeral nature of consumer-generated media which constitutes the majority of the current 2D social Web and will make up the majority of expanding 3D social Web content.

Whilst SL/OpenSim encapsulates many of the desirable architectural features for 3D PoSR experiments it does not support execution upon familiar mobile platforms (Android/iOS) nor does it provision for avatar control from sensor data. However the open source nature of the SL viewer allowed modifications to be effected, enabling control of the avatar and camera from real time data collected from position and orientation sensors connected to a tablet computer. This ability to control navigation within the 3D virtual environment without explicit conscious input of keyboard/mouse/touch commands is integral to reducing the cognitive load required to maintain a presence within a virtual environment which is a key requirement for overcoming the vacancy problem and achieving successful mobile cross reality.

As the SL viewer is only available for x86 platforms the choice of user hardware platform for the experiments was limited, with the MSI WindPad 110W presenting the most promising solution: a 10'' tablet computer sporting an AMD Brazos Z01 APU (combining a dual-core x86 CPU and Radeon HD6250 GPU)~\cite{Micro-StarInt'lCo.}. The user's position was monitored using GPS, a solution which is well suited to applications of the system within the use case of cultural heritage; such sites often constitute outdoor ruins at which a clear view of the sky allows for good GPS connectivity. For use cases where a similar modality of interaction is desired whilst indoors then an indoor positioning system would be used; a roundup of such technologies is available in~\cite{Mautz2012}.

To reduce computational load on the 110W, the OpenSim server was run on a separate Lenovo ThinkPad X61s laptop computer during the experiments. Due to the limited range of the laptop's wireless interface, the laptop was connected by RJ45 ethernet cable to a Linksys WRT54G wireless router to allow the 110W to access the OpenSim server wirelessly from anywhere within the experiment area. The router was powered from a 12V sealed lead-acid battery. This setup is shown in figure \ref{server}.

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/server}
%\caption{Lenovo ThinkPad X61s laptop, Linksys WRT54G wireless router and sealed lead-acid battery providing OpenSim server via wireless to the 110W.}
%\label{server}
%\end{figure}

\subsection{GPS Configuration}
The 110W features an AzureWave GPS-M16~\cite{AzureWave} GPS receiver; however poor API provision and meager documentation lead to use of a separate u-blox MAX-6 GPS receiver~\cite{U-bloxAG} outfitted with a Sarantel SL-1202 passive antenna~\cite{Sarantel}. The MAX-6 is of higher operational specification than the GPS-M16 and supports Satellite Based Augmentation Systems (SBAS) which improve the accuracy of location data by applying additional correction data received from networks of satellites and ground-based transmitters separate to those of the GPS system. These networks include the European Geostationary Navigation Overlay Service (EGNOS) that covers the UK where the experiments took place.

The product summary for the MAX-6 claims accuracy of 2.5m Circular Error Probable (CEP) without SBAS corrections and 2m CEP with SBAS corrections ``demonstrated with a good active antenna''~\cite{U-bloxAG2012}. This means that, in an ideal situation with SBAS correction data available, there would be 50\% certainty that each position reported by the GPS receiver would be within 2m of its actual position. The SL-1202 antenna used is passive, however as the distance between antenna and the MAX-6 IC itself in the hardware application is only a few millimeters there would have been negligible benefit from using an active antenna. However whether the SL-1202 constitutes `good' for achieving the headlining performance characteristics of the MAX-6 is debatable as the definition of `good' was not provided in the product summary.

The MAX-6 was operated in `pedestrian' dynamic platform model, use of SBAS correction data was enabled and frequency of readings was set to the maximum of 5Hz.

To determine the real world accuracy attainable with the MAX-6 outfitted with the SL-1202 in situations akin to those of the cultural heritage case study, a walking route around the St Andrews cathedral ruins, akin to the route that an individual visitor or school group might take, was planned and then walked with the MAX-6 connected to a laptop computer via an Arduino operating as a Universal Asynchronous Receiver/Transmitter (UART) feeding the raw National Marine Electronics Association (NMEA) messages into the `u-center'GPS evaluation software version 7.0 which logged the messages for later evaluation. Simultaneously for comparative purposes a mid-range consumer Android smartphone was used to record the same track; a HTC One S~\cite{HTCCorporation2013} containing a gpsOne Gen 8A solution within its Qualcomm Snapdragon S4 processor~\cite{QualcommIncorporated2013} and using Google's `My Tracks' app version 2.0.3 to record the data. The three sets of positional data (planned route, MAX-6 recorded route and smartphone recorded route) were entered into a PostgreSQL database~\cite{Daviesc,Daviesb} and the PostGIS database extender's ST\_HausdorffDistance algorithm~\cite{PostGIS} was used to calculate the Hausdorff distances between the recorded routes and the planned route and between the recorded routes themselves. In this scenario, the Hausdorff distance represents the furthest distance needed to travel from any point on the route recorded by the GPS receiver to reach the nearest point on the planned route. Because of the substantially greater inaccuracies identified in the latter part of the recorded tracks, separate Hausdorff distances were calculated both for the complete tracks and also for truncated first and second sub-tracks.

\subsection{GPS to OpenSim conversion}
Translating real world positions, obtained via the GPS receiver as latitude and longitude pairs, into corresponding OpenSim (X,Y) region coordinates is achieved using the haversine formula~\cite{Gellert1989} from spherical trigonometry. The prerequisites for this approach are that the OpenSim model is aligned correctly to the OpenSim compass as the real location is aligned to real bearings (although provision to specify an `offset' within the Pangolin viewer for non-aligned models would be a trivial addition), that the model was created to a known and consistent scale and that a single `anchor point' is known for which both the real world latitude/longitude and corresponding OpenSim (X,Y) region coordinates are known.

Using the haversine formula the great-circle (or orthodromic) distance between the latitude of the anchor point and the latitude of the new GPS reading is calculated, then applying the scale of the model results in the equivalent distance in OpenSim metrics between the Y coordinate of the anchor point and the Y coordinate of the position corresponding to the new GPS reading. Repeating the same calculations with the longitude of the new GPS reading provides the distance between the X coordinate of the anchor point and the X coordinate of the position corresponding to the new GPS reading. Adding or subtracting these distances as appropriate to the OpenSim coordinates of the anchor point provides the OpenSim coordinates that correspond to the new GPS reading, to which the avatar is then instructed to move.

The anchor point is specified using global coordinates, not local coordinates. This allows navigation to operate across region boundaries and within mega regions (it is not limited to a single 256x256 meter OpenSim region) and there are no restrictions for the placement of the OpenSim component of the anchor point (it can be anywhere in any region, movement of the avatar can be in any direction from it (positive and negative), it does not have to be at the center of the model or even in a region that the model occupies).

Calculating a global coordinate is simply a case of multiplying the position of the region by 256 and then adding the local coordinate. For example, for an anchor at local coordinate $(127,203,23)$ within a region that is at $(1020,1042)$ the global X coordinate is calculated as $(1020 * 256) + 127 = 261247$ and the global Y coordinate as $(1043 * 256) + 203 = 267211$. Elevation (Z) is ignored due to a combination of the relatively low accuracy of these data attainable via GPS (when compared to the longitudinal/latitudinal accuracy) and as the case study explored involved users navigating outdoor ruins remaining at ground level.

\subsection{Orientation}
To control the SL camera in the required fashion, sensor data is collected for the direction that the user is facing (in terms of magnetic compass bearing) and the vertical angle (pitch) at which they are holding the tablet. Magnetic compass bearing is sensed using a magnetometer and pitch by an accelerometer. Roll data is also captured by the accelerometer, however it was expected that users would keep the tablet in a roughly horizontal fashion when interacting with it, thus using these data to control the SL camera's roll was not deemed to be beneficial and was not implemented.

The 110W does not feature a magnetometer and its tilt sensor is rudimentary (only useful for differentiating between discrete cases of landscape and portrait orientation for screen rotation). Several alternative sensors were auditioned, including the MMA8452, ADXL335, HMC5883L and eventually the HMC6343 which was adopted for the experiments. The HMC6343 combines a 3-axis magnetometer, 3-axis accelerometer and algorithms to internally apply the accelerometer's readings to tilt compensate the magnetometer's readings; tilt compensation is necessary for an accurate compass bearing when the device is not held in a perfectly level orientation, such as when the user tilts it up or down to view content above or below their eye level.

Magnetic declination information was entered into the HMC6343 for the position of the cathedral and the date of our experiments. The HMC6343's hard-iron offset calculation feature was used each time the hardware configuration was altered. The sampling frequency of the HMC6343 was set to its highest value of 10Hz. Orientation was set to `upright front' to match the physical orientation of the IC in the experiments.

\subsection{Interfacing GPS/Orientation hardware with SL}
The MAX-6 and HMC6343 were connected to an Arduino (the setup used throughout the experiments is shown in figure \ref{arduino}) and a `sketch' (the name given to programs that execute upon the Arduino platform) written to receive the data from the ICs, perform simple processing upon them and relay them to the tablet via USB connection~\cite{Davies}. The TinyGPS library~\cite{Hart} was used to abstract processing of NMEA messages from the MAX-6 to obtain the required latitude and longitude values.
 
%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_8}
%\caption{The HMC6343, MAX-6 and SL-1202 connected via a breadboard prototyping shield to the Arduino, in the setup and configuration that was then attached to the rear of the 110W for the experiments.}
%\label{arduino}
%\end{figure}

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/tablet_back}
%\caption{The setup from figure \ref{arduino} attached to the rear of the 110W. The sensors are configured such that (in the orientation of this photograph) the X axis is positive pointing straight down, Y is positive pointing straight right and Z is positive pointing perpendicular out of the rear face of the tablet.}
%\label{tablet_back}
%\end{figure}

Leveraging standard SL avatar/camera control interfaces was explored by programming the Arduino to mimic a standard USB HID joystick via the Lightweight USB Framework for AVRs (LUFA), sending messages that the viewer interpreted as coming from a joystick and allowing the use of the standard joystick options. However the granularity of control attainable via this method was not sufficient and thus the viewer was modified (giving rise to the Pangolin viewer) to make use of the Boost.Asio C++ library to support receiving data via serial port and to use these data to control the movement of the avatar and camera by directly interfacing with the control functions at a lower level of abstraction. Receipt of messages is performed in an asynchronous non-blocking fashion, with the viewer's main loop processing the most recently received message in each iteration. Messages follow the format

$\langle bearing \rangle$ $\langle pitch \rangle$ $\langle roll \rangle$ $\langle latitude \rangle$ $\langle longitude \rangle$

The viewer's GUI was modified with the addition of a dialogue that allows the user to specify the path of the serial device, separately enable or disable sensor-driven camera and movement control, as well as providing numerous controls for fine-tuning its behavior, including the ability to specify high-pass filters for avatar movement and specify the smoothing applied to camera control. This GUI also presents the necessary fields for input of the anchor point details and fields for diagnostic output of the received information. Figure \ref{pangolin_screenshot} shows this GUI within the Pangolin viewer.

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_9}
%\caption{The GUI within the Pangolin viewer that allows administration of the position and orientation control of the avatar. In this screenshot Pangolin is connected to the Arduino and is receiving position and orientation data.}
%\label{pangolin_screenshot}
%\end{figure}

\section{Results}
Two plausible modalities of interaction were identified for this system, with each presenting different requirements with regards to accuracy of position tracking.

The first modality is one in which a number of locations that represent points of particular interest are identified. This is already a common practice at cultural heritage sites, with such locations often bearing signs or placards presenting text and/or images explaining what can be observed from the position. With Pangolin, when a user walks within a certain range of such a point, their avatar can be moved to the corresponding location within the reconstruction (and a sound played to alert the user to the fact that there is something of interest to observe) from which they can then move the tablet around them to examine their surroundings in the reconstruction. This modality is similar to audio tours employed by many museums and cultural heritage sites, but replaces the requirement to follow a static route or type in numbers of locations with the ability to freely navigate the real environment with access to additional information being triggered automatically once within the required range of a point of interest.

The second modality is one of free roaming exploration, in which the movements of the user's avatar within the reconstruction mimic the user's movements within the real world as closely as possible.
The first modality can be scaled to function with different accuracies of position tracking; as long as the distance between any two points of interest is at least as much as the worst case performance of the position tracking then distinguishing correctly between different points will always succeed. The second modality requires extremely accurate position tracking, arguably surpassing the capabilities of mainstream GPS technology even in ideal situations.

During the experiments the MAX-6 was unable to maintain reception of the additional correction data required for SBAS operation; when left stationary for several minutes reception was possible however subsequent movement of only a few meters at walking pace broke the connection. This reduced the theoretical maximum performance of the unit to 2.5m CEP, with observed performance being lower. Figure \ref{map_one} depicts an aerial view of the St Andrews cathedral ruins; the blue line represents the planned route, red the route recorded by the MAX-6 receiver and green the route recorded by the smartphone for comparative purposes, both while walking the planned route.

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_4}
%\caption{Aerial view oriented North upward of the St Andrews cathedral ruins; the blue line represents the planned route, red the route recorded by the MAX-6 and green the route recorded by the smartphone whilst walking the planned route.}
%\label{map_one}
%\end{figure}

The Hausdorff distance between the planned route and that recorded by the MAX-6 was $1.02e^{-04\circ}$. The `length' of a degree of latitude and a degree of longitude depends upon location upon the Earth; around the location of the St Andrews cathedral 1$^\circ$ of latitude is equivalent to 111347.95m and 1$^\circ$ of longitude to 61843.88m. Thus the Hausdorff distance of $1.02e^{-04\circ}$ can be visualized as $\pm11.3$m of North/South inaccuracy or $\pm6.3$m of East/West inaccuracy (or a combination of both N/S and E/W inaccuracy not exceeding a total displacement of $1.02e^{-04\circ}$ from the planned route).

The MAX-6 did achieve better performance than the smartphone, which recorded a Hausdorff distance of $1.33e^{-04\circ}$ ($\pm14.8$m N/S, $\pm8.2$m E/W). The Hausdorff distance between the routes logged by the MAX-6 and the smartphone was $1.14e^{-04\circ}$ ($\pm12.7$m N/S, $\pm7.0$m E/W), which represents a low correlation between the inaccuracies recorded by the two receivers even though they are of similar magnitudes from the planned route.

The maximum inaccuracies were recorded when walking along the South wall of the cathedral's nave. This wall is one of the most complete sections of the building with stonework reaching some 30ft above ground level and providing an effective obstruction to line-of-sight to half of the sky (and substantially impairing reception of signals from GPS satellites) when in close proximity to it. When considering just the sub-route shown in figure \ref{map_two}, which terminates before this wall begins to significantly obstruct view of the sky, the Hausdorff distances are notably smaller; the MAX-6 achieved a Hausdorff distance of $7.23e^{-05\circ}$ ($\pm8.05$m N/S, $\pm4.47$m E/W) throughout this sub-route, with the smartphone still behind with $8.99e^{-05\circ}$ ($\pm10.01$m N/S, $\pm5.56$m E/W). Again the Hausforff distance between the receivers showed low correlation between the inaccuracies, at $6.43e^{-05\circ}$ ($\pm7.12$m N/S, $\pm3.98$m E/W).
 
%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_5}
%\caption{Aerial view oriented North upward of the St Andrews cathedral ruins; the blue line represents the first sub-route of the planned route, red the sub-route recorded by the MAX-6 and green the sub-route recorded by the smartphone whilst walking the first planned sub-route.}
%\label{map_two}
%\end{figure}

When analyzing the tracks in the vicinity of the nave (see figure \ref{map_three}) it is shown that although the MAX-6 outperformed the smartphone in terms of Hausdorff distance this relationship can be considered misleading as the smartphone track corresponded more closely in shape to the planned route even if it did stray further at its extreme. The discrepancy in the behavior of the two receivers in this situation is attributed to different implementations of dead-reckoning functionality between the receivers. Dead-reckoning is the process used when a GPS receiver loses reception of location data from satellites and extrapolates its position based upon a combination of the last received position data and the velocity of travel at the time of receiving these data.
 
%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_6}
%\caption{Aerial view oriented North upward of the St Andrews cathedral ruins; the blue line represents the second sub-route of the planned route, red the sub-route recorded by the MAX-6 and green the sub-route recorded by the smartphone whilst walking the second planned sub-route.}
%\label{map_three}
%\end{figure}

Pangolin's camera control from orientation data does not have as stringent performance criteria as the movement control from position data. Unlike augmented reality where sparse virtual content is superimposed upon a view of a real environment and the virtual objects must be placed accurately in order for the effect to work well, cross reality presents a complete virtual environment that is viewed `separately' or side-by-side with the real environment and thus discrepancies between orientation of real and virtual environments have a less detrimental effect to the experience. Although the accuracy of the camera control during the experiments was reported as being sufficient, the speed at which the camera orientation moved to match physical orientation was reported as being too slow, resulting in having to wait for the display to `catch up' to changes in orientation. This is attributed to the 10Hz sampling rate of the orientation sensors which, particularly after readings are combined for smoothing purposes to reduce jerky movement, resulted in too infrequent orientation updates. Frame rates within Pangolin whilst navigating the route averaged between 15 and 20 frames per second with the viewer's `quality and speed' slider set to the `low' position.

The style of explorative interaction with virtual content that this system employs is more resilient to input lag and low frame rates than other scenarios of interaction with virtual content such as fast paced competitive video games including First Person Shooters (FPS) [20], but overall user experience would nonetheless be improved by a faster sampling of orientation data and a higher frame rate. Additionally it should be noted that the cathedral reconstruction was created with relatively powerful desktop computers in mind as the primary deployment platform and has not been optimized for use on less powerful mobile platforms such as Pangolin. Performance of Pangolin on a less graphically complex OpenSim region (Salt Pan 2 [17]), that also depicts a reconstruction of a cultural heritage site, was better at 20 to 25 frames per second at the `low' position and between 15 and 20 frames per second at `high' (see figure 7).

%\begin{figure}[h]
%\centering
%\includegraphics[width=0.48\textwidth]{images/figure_7}
%\caption{Plot of Pangolin's performance (measured in frames per second) against different graphical settings (selected via the `Quality and speed' slider of the viewer) in two positions within the Salt Pan 2 region.}
%\label{framerate_graph}
%\end{figure}

\section{Interpretations}
The positional accuracy of $1.02e^{-04\circ}$ attained by the MAX-6 is sufficient for the first modality of interaction (that of distinguishing and navigating between multiple points of interest). This value of $1.02e^{-04\circ}$ (analogous to a combination of $\pm11.3$m of North/South inaccuracy or $\pm6.3$m of East/West inaccuracy) represents a constraint on the granularity of the content; it is the minimum distance required between any two points of interest for them to be correctly differentiated between. This same value is not sufficient for the second modality of interaction (that of free roaming exploration with avatars mimicking their users' movements as closely as possible). This modality would require the use of additional position tracking techniques to improve accuracy to around 1m CEP (analogous to $8.98e^{-06\circ}$ latitude or $1.62e^{-05\circ}$ longitude around the location of the St Andrews cathedral).

Use of a GPS receiver that is lower performance than the MAX-6 used by Pangolin, but more common due to being of the calibre integrated into smartphones and tablets such as that used in the experiments, is still sufficient for the first modality but with a larger minimum distance required between any two points of interest. The Hausdorff distance of $1.33e^{-04\circ}$ recorded by the smartphone used in the experiments is analogous to $\pm14.8$m N/S or $\pm8.2$m E/W around the location of the cathedral.

Observed accuracy of the orientation tracking is sufficient for both modalities of interaction; the accuracy of orientation tracking required does not change with different positional accuracy and the accuracy of orientation attained in the experiments is sufficient for an acceptable user experience, however the experience would benefit from better graphical quality and higher responsiveness to changes in user orientation.

\section{Conclusions}
Manifestations of PoSR involving 2D content are commonplace, but whilst the social allures and educational benefits of 3D environments have been recognized the ability to forge PoSR situations involving 3D content remains elusive. As development of 3D Web technologies furthers, the demand for 3D PoSR will grow. The cross reality concept, when freed from static linking between physical and virtual environments, provides a technique to address this shortcoming. This technique has been investigated by the Pangolin virtual world viewer as a mobile, location and orientation aware cross reality interface to spatially related 3D virtual environments. Pangolin aimed to provide a platform for furthering previous use of such 3D environments, for allowing students to learn from reconstructions of cultural heritage content, by allowing them to interact with such reconstructions whilst simultaneously exploring the corresponding physical environments.

Performance of position tracking by GPS emerged as a constraint upon the modality of interaction possible in such systems, with commercially available non-assisted GPS receivers, of the quality built into smartphones and tablets, capable of sufficient accuracies for the `points of interest' modality to function correctly but not for the free roaming exploration modality.

These conclusions hold for today's commodity technology. We can expect the resolution, processing power and rendering capability of mobile phones and tablets to continue to increase for any fixed price point. Similarly, augmented positioning systems providing greater positional accuracy are likely to emerge. Thus we conclude that the benefits of having accurate virtual interpretations of historic locations available at the sites in a mobile fashion will be available for school visits, cultural heritage investigation and tourists of the future. As mobile 3D cross reality technology becomes common place and matures, applications in education, entertainment, business and the arts will emerge that will surprise us all.